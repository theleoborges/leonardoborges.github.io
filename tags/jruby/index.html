<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Leonardo Borges</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="Leadership. Technology. AI.">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
      <meta name="robots" content="index, follow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.1a1e856c575c37c0a14fa63fe637fefcac5fc8a9e372c7d8de0184b5ab217407.css" >



    

    
      
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />


    

    
    
      <link href="/tags/jruby/index.xml" rel="alternate" type="application/rss+xml" title="Leonardo Borges" />
      <link href="/tags/jruby/index.xml" rel="feed" type="application/rss+xml" title="Leonardo Borges" />
      
    

    
      <link rel="canonical" href="http://leonardoborges.com/tags/jruby/">
    

    <meta property="og:url" content="http://leonardoborges.com/tags/jruby/">
  <meta property="og:site_name" content="Leonardo Borges">
  <meta property="og:title" content="JRuby">
  <meta property="og:description" content="Leadership. Technology. AI.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="JRuby">
  <meta itemprop="description" content="Leadership. Technology. AI.">
  <meta itemprop="datePublished" content="2010-01-02T00:00:00+00:00">
  <meta itemprop="dateModified" content="2010-01-02T00:00:00+00:00">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="JRuby">
  <meta name="twitter:description" content="Leadership. Technology. AI.">

      
    
	
  </head><body class="ma0 avenir bg-near-white production">

    

  
  
  <header class="cover bg-top" style="background-image: url('http://leonardoborges.com/images/wanaka_tree.jpg');">
    <div class="bg-black-60">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Leonardo Borges
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/books/" title="Books page">
              Books
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://leonardoborges.substack.com/p/leadership-coaching" title="Coaching page">
              Coaching
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://leonardoborges.substack.com/" title="Newsletter page">
              Newsletter
            </a>
          </li>
          
        </ul>
      
      <div class="ananke-socials"><a href="https://github.com/theleoborges/" target="_blank" rel="noopener"
        class="ananke-social-link link-transition github link dib z-999 pt3 pt0-l mr1"
        title="follow on GitHub - Opens in a new window"
        aria-label="follow on GitHub - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
            
          </span></a><a href="https://twitter.com/theleoborges" target="_blank" rel="noopener"
        class="ananke-social-link link-transition twitter link dib z-999 pt3 pt0-l mr1"
        title="follow on Twitter - Opens in a new window"
        aria-label="follow on Twitter - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
            
          </span></a><a href="http://linkedin.com/in/theleoborges" target="_blank" rel="noopener"
        class="ananke-social-link link-transition linkedin link dib z-999 pt3 pt0-l mr1"
        title="follow on LinkedIn - Opens in a new window"
        aria-label="follow on LinkedIn - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
            
          </span></a></div>

    </div>
  </div>
</nav>

      <div class="tc-l pv4 pv6-l ph3 ph4-ns">
        <h1 class="f2 f-subheadline-l fw2 white-90 mb0 lh-title">
          JRuby
        </h1>
        
      </div>
    </div>
    
  </header>


    <main class="pb7" role="main">
      
  <article class="cf pa3 pa4-m pa4-l">
    <div class="measure-wide-l center f4 lh-copy nested-copy-line-height nested-links mid-gray">
      <p>Below you will find pages that utilize the taxonomy term “JRuby”</p>
    </div>
  </article>
  <div class="mw8 center">
    <section class="flex-ns flex-wrap justify-around mt5">
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2010/01/02/managing-multiple-ruby-versions/" class="link black dim">
        managing multiple ruby versions
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
Today I read a nice <a href="http://akitaonrails.com/2010/01/01/limpando-meu-ambiente-de-desenvolvimento" target="_blank">post</a> - in Portuguese - by <a href="http://akitaonrails.com/" target="_blank">Fábio Akita</a> on how to manage multiple ruby versions on your machine. I've tried it once with some tool I can't even remember the name but failed miserably.<br><br>But this time things look very different. The tool here is the <a href="http://rvm.beginrescueend.com" target="_blank">rvm</a> - short for Ruby Version manager - and it works just great.<br><br>Let's cut to the chase and imagine that you, like me, want to run/develop/test your code on both ruby 1.8.7 and ruby 1.9.1. These steps would get you up and running in a few minutes:<br><br><strong>Install rvm:</strong><br><pre lang="bash"><br>$ gem sources -a http://gemcutter.org/<br>$ gem install rvm<br>$ rvm-install<br>$ echo "if [[ ! -z $HOME/.rvm ]] ; then source $HOME/.rvm ; fi" >> ~/.bash_profile<br>$ source ~/.rvm/scripts/rvm<br></pre><br><br><strong>Install the ruby interpreters you want to use:</strong><br><pre lang="bash"><br>$ rvm  install ruby-1.8.7-p160<br>$ rvm  install ruby-1.9.1<br></pre><br><br>Now it's important to notice that at this point you have separate gem installations for each of the interpreters you've installed in the previous step. That said, just go ahead and switch between your interpreters and use your command line scripts - ruby, gem, etc... - as usual.<br><br><strong>Switching between interpreters:</strong><br><pre lang="bash"><br>$ rvm ruby-1.8.7-p160  #switch to the specified version <br>$ ruby -v<br>ruby 1.8.7 (2009-04-08 patchlevel 160) [i686-darwin9.8.0]<br>$ gem install rails  #note I'm not using sudo since the new gem paths point to the user's home directory <br><br>$ rvm ruby-1.9.1  #switch to the specified version <br>$ ruby -v<br>ruby 1.9.1p376 (2009-12-07 revision 26041) [i386-darwin9.8.0]<br>$ gem install rails  #note I'm not using sudo since the new gem paths point to the user's home directory<br></pre><br><br>And that's it, just go on and install rails, merb, sinatra or whatever rocks your boat!<br>rvm will work with MRI/YARV, JRuby, Ruby EE and Rubinius. Enjoy and don't forget to check <a href="http://rvm.beginrescueend.com" target="_blank">rvm</a>'s website for the complete documentation! :) 
</p>
    </div>
    <a href="/writings/2010/01/02/managing-multiple-ruby-versions/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2009/09/18/refactoring-for-readability/" class="link black dim">
        refactoring for readability
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
Yesterday I've done something I should do more often: Revisit some code written a while ago for our current project and make it better.<br><br>Let's face it. We all write crappy code the 1st time. The difference is in what we do about it afterwards.<br>We might decide it's good enough and keep moving, or we could (and should!) stop and refactor it!<br><br>The code I revisited worked as a refactoring exercise and it's initial version is shown below:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jphoto</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e">#a few other methods ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">post_photo</span>(file_data, hotel_id, send_rss, options <span style="color:#f92672">=</span> {})
</span></span><span style="display:flex;"><span>   file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tmp/</span><span style="color:#e6db74">#{</span><span style="color:#66d9ef">Time</span><span style="color:#f92672">.</span>now<span style="color:#f92672">.</span>to_i<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">#{</span>rand(<span style="color:#ae81ff">1000000</span>)<span style="color:#f92672">.</span>to_s(<span style="color:#ae81ff">36</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">File</span><span style="color:#f92672">.</span>open(file_name, <span style="color:#e6db74">&#34;wb&#34;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>f<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>     f<span style="color:#f92672">.</span>puts(file_data)
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>file(<span style="color:#e6db74">&#39;photo&#39;</span>,file_name),
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;hotel&#39;</span>, hotel_id),
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;source&#39;</span>,<span style="color:#e6db74">&#39;PhotoUploadTest&#39;</span>)<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   extract_extra_params!(params, options)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   c <span style="color:#f92672">=</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Easy</span><span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">#{</span>service_uri_base<span style="color:#e6db74">}</span><span style="color:#e6db74">/photoupld&#34;</span>)
</span></span><span style="display:flex;"><span>   c<span style="color:#f92672">.</span>multipart_form_post <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>   c<span style="color:#f92672">.</span>http_post(<span style="color:#f92672">*</span>params)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span> c<span style="color:#f92672">.</span>response_code <span style="color:#f92672">!=</span> <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>     error_msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;File upload failed with code: </span><span style="color:#e6db74">#{</span>c<span style="color:#f92672">.</span>response_code<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">Rails</span><span style="color:#f92672">.</span>logger<span style="color:#f92672">.</span>info error_msg
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">raise</span> error_msg
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">File</span><span style="color:#f92672">.</span>delete(file_name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   hotel <span style="color:#f92672">=</span> <span style="color:#66d9ef">Hotel</span><span style="color:#f92672">.</span>find_by_id(hotel_id)
</span></span><span style="display:flex;"><span>   hotel<span style="color:#f92672">.</span>cache<span style="color:#f92672">.</span>destroy_all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   send_upload_rss(hotel, original_upload_url(c<span style="color:#f92672">.</span>body_str) , options) <span style="color:#66d9ef">if</span> send_rss
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">private</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_upload_rss</span>(hotel, photo_url, options)
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">manage_images_link</span>(hotel_id)
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">extract_extra_params!</span>(params, options)
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;status&#39;</span>, options<span style="color:#f92672">[</span><span style="color:#e6db74">:status</span><span style="color:#f92672">]</span>) <span style="color:#66d9ef">if</span> options<span style="color:#f92672">[</span><span style="color:#e6db74">:status</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;upload_source&#39;</span>, options<span style="color:#f92672">[</span><span style="color:#e6db74">:upload_source</span><span style="color:#f92672">]</span>) <span style="color:#66d9ef">if</span> options<span style="color:#f92672">[</span><span style="color:#e6db74">:upload_source</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;uploader_ip&#39;</span>, options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_ip</span><span style="color:#f92672">]</span>) <span style="color:#66d9ef">if</span> options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_ip</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;uploader_email&#39;</span>, options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_email</span><span style="color:#f92672">]</span>) <span style="color:#66d9ef">if</span> options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_email</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p><br>Look at the post_photo method. It has problems in so many levels that it&rsquo;s hard to start. <br>Methods should do &ldquo;one thing&rdquo; and that method obviously does much more than that, mixing different levels of abstraction.<br><br>But let&rsquo;s start with the easy parts first, keeping in mind that I was aiming for readability.<br><br>Lines 7 to 10 seem to be there just to make the reader&rsquo;s life harder. It&rsquo;s creating a temporary file through some custom logic instead of using the tools provided by the language. Unnecessary and only pollutes our eyes. My first measure was to use ruby&rsquo;s TempFile class for this. Better, but we still have a long way.<br><br>Right at line 12 it creates some sort of default parameters list, after which it extracts some extra options. I don&rsquo;t know what that method does but it&rsquo;s clearly using output arguments, which we should avoid at all costs, as they lead to confusion. This is a big smell as well, and another refactoring step added to my list.<br><br>On line 21 starts the code that handles what to do when we get a response_code other than 200 from our request. Apart from the fact that this code doesn&rsquo;t feel right here, we just happen to know that in HTTP, 200 means success, but that might not be clear to someone looking at the code for the 1st time.<br><br>Then the code goes on to delete the temp file, clear the hotel&rsquo;s cache and send the rss if the rss&rsquo; flag is true.<br><br><strong>Let there be refactoring&hellip;.</strong><br><br>Geez, how many lines have I used to explain what the code does? Since I don&rsquo;t wanna bore you to death, here is my refactored version of this method, trying to avoid as much as I can the problems I highlighted previously:<br><br><br><br></p>
    </div>
    <a href="/writings/2009/09/18/refactoring-for-readability/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2009/09/03/rails-summit-2009-im-speaking/" class="link black dim">
        rails summit 2009 im speaking
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
<a href="http://www.railssummit.com.br?utm_campaign=Railssummit&amp;utm_source=banner_parceiros&amp;utm_medium=banner&amp;utm_content=en_souPalestrante_210x60"><img src="http://railssummit.com.br/images/banners/en_souPalestrante_210x60.jpg" alt="Rails Summit 2009" /></a><br><br>I'll be speaking at this year's <a href="http://railssummit.com.br/en/pages/home" target="_blank">Rails Summit Latin America</a> in Sao Paulo, Brazil. It will be a good opportunity to meet some <a href="http://railssummit.com.br/en/speakers">amazing people</a> and visit friends back home! :)<br><br>Overall I'll be spending 12 days in Brazil, with 2 of them dedicated to the conference. The other 10 I'll be in Rio de Janeiro visiting my family and friends. I strongly advise you to spend some time in Rio too, if at all possible. It's an amazing city and you can contact me if you have any questions.<br><br>Back to the conference, my session is called <strong>JRuby in the enterprise world: Using Rails with legacy code</strong>, and will be given in the form of a tutorial. I will walk you through some problems we had while making this kind of integration at my company, focusing mostly on dependency management.<br><br>At the end I hope you'll have a good understanding of what JRuby is capable of in a legacy environment.<br><br>If you're planning to attend and would like to hear anything specific about JRuby, please let me know, I can try and squeeze in.<br><br>C u there!
</p>
    </div>
    <a href="/writings/2009/09/03/rails-summit-2009-im-speaking/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2009/07/31/jvm-language-preferences-poll-results/" class="link black dim">
        jvm language preferences poll results
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
<strong>- Overall results</strong><br><br>First off, I'd like to thank everyone who voted on this poll.<br>With a total of 236 votes, here is the summary of the first two questions:<br><br><strong>- Are you currently working with or researching about language alternatives for the JVM? - e.g. JRuby, Scala, Groovy</strong><br><br><a href='/assets/images/scala_improvements.png'>{% img /assets/images/scala_improvements.png %}</a></em><br><br>Tooling. The majority of comment urge for better tooling and IDE support. That simple.<br><br><strong>- Others</strong><br><br>People who chose others mentioned <a href="http://clojure.org/" target="_blank">Clojure</a>, <a href="http://www.fandev.org/" target="_blank">Fan</a> and <a href="http://www.jython.org/">Jython</a>, with a clear advantage for Clojure.<br><br><strong>- Disclaimer</strong><br><br><strong>This poll has no scientific foundations whatsoever and its sole purpose is to summarize the feelings and personal choices of the people who answered it. If you would like the original spreadsheet with the answers, you can find it <a href="http://spreadsheets.google.com/ccc?key=0AuABB6DyTXV2dHEtZnNwSDhCb2RVOThFcUNaSUhpbEE&amp;hl=en" target="_blank">here</a> and do your own analyzis.<br></strong>
</p>
    </div>
    <a href="/writings/2009/07/31/jvm-language-preferences-poll-results/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2009/07/01/jruby-on-rails-and-legacy-java-apps-managing-dependencies/" class="link black dim">
        jruby on rails and legacy java apps managing dependencies
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
The motivation for this post came from a couple of messages I've seen on the jruby's google group and because I think it's pretty cool to share how we tackled this problem.<br><br><strong>- A little bit of context</strong><br><br>We, as a vast amount of people out there, have legacy Java code. A lot. In our case this legacy is pretty much crucial to our business. We can't just trash it and start from scratch. Bad idea.<br><br>On the other hand we do have new features to be built on top of it. But we wanted an easier way to develop this new stuff and decided for a JRuby on Rails solution, using it as a front-end to our existing services.<br><br><strong>- What we decided to do</strong><br><br>Our final rails project would make use of a specially created jar file containing our Java application. This Jar would also contain a public interface of the services we'd have to interact with from rails.<br><br>As any Java application, ours depend on a number of external jar files that correspond to the various framewoks we usually have in place. e.g.: Hibernate, Spring, apache-commons ...<br><br>Which means we need to make our app's jar and all it's dependencies available in the JRuby classpath in order to use it.<br><br>Given we're using warbler to package our application as a war file, we just need to place all jars needed into our rails app's lib folder. Warbler then takes care of copying any jar files located in there into the war.<br><br><strong>- The problem</strong><br><br>So we needed a smart way to include all these dependencies into the project, and copy/paste isn't an option.<br><br>In the Java world we use <a href="http://maven.apache.org/">Maven</a> to manage our projects dependencies - and you should too. Because of that our approach involved turning our rails application into a Maven aware project.<br><br>Basically we needed a <a href="http://maven.apache.org/pom.html">pom file</a> that would declaratively list our java project as a dependency. From there on, Maven knows what the dependencies are and downloads them to your local repository.<br><br>Which leaves us with one more task. We need to put all these dependencies into our lib folder after maven has downloaded them.<br><br>Below you'll find the pom.xml file that we use to achieve this with inline comments explaining each bit:<br>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span> <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;modelVersion&gt;</span>4.0.0<span style="color:#f92672">&lt;/modelVersion&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;groupId&gt;</span>com.company<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">&lt;!-- notice how we specify the packaging to be a war,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">          that way, maven knows where to copy the jar files --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;packaging&gt;</span>war<span style="color:#f92672">&lt;/packaging&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;artifactId&gt;</span>railsApp<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;name&gt;</span>railsApp<span style="color:#f92672">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;groupId&gt;</span>com.company<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;artifactId&gt;</span>java-legacy-app<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;version&gt;</span>1.0-SNAPSHOT<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;scope&gt;</span>compile<span style="color:#f92672">&lt;/scope&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependencies&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;build&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;finalName&gt;</span>railsApp<span style="color:#f92672">&lt;/finalName&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;plugins&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;groupId&gt;</span>org.codehaus.mojo<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;artifactId&gt;</span>exec-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;executions&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;execution&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">&lt;!-- This tasks only creates a basic structure expected by maven,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                    so it can do its work --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;id&gt;</span>create-mock-web-descriptor<span style="color:#f92672">&lt;/id&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;phase&gt;</span>compile<span style="color:#f92672">&lt;/phase&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;executable&gt;</span>/bin/sh<span style="color:#f92672">&lt;/executable&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;workingDirectory&gt;</span>.<span style="color:#f92672">&lt;/workingDirectory&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;arguments&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;argument&gt;</span>-c<span style="color:#f92672">&lt;/argument&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;argument&gt;</span>
</span></span><span style="display:flex;"><span>                    mkdir -p src/main/webapp/WEB-INF
</span></span><span style="display:flex;"><span>                    touch    src/main/webapp/WEB-INF/web.xml
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/argument&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;/arguments&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;goals&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;goal&gt;</span>exec<span style="color:#f92672">&lt;/goal&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/goals&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;/execution&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;execution&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">&lt;!-- Now in the package phase we copy the jar files
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                    that maven put into the fake web app to our rails&#39; lib folder --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;id&gt;</span>copy-needed-jars-into-lib<span style="color:#f92672">&lt;/id&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;phase&gt;</span>package<span style="color:#f92672">&lt;/phase&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;executable&gt;</span>/bin/sh<span style="color:#f92672">&lt;/executable&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;workingDirectory&gt;</span>.<span style="color:#f92672">&lt;/workingDirectory&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;arguments&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;argument&gt;</span>-c<span style="color:#f92672">&lt;/argument&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;argument&gt;</span>
</span></span><span style="display:flex;"><span>                    rm -f lib/*.jar
</span></span><span style="display:flex;"><span>                    cp target/railsApp/WEB-INF/lib/*.jar lib
</span></span><span style="display:flex;"><span>                    rm -rf target/railsApp*
</span></span><span style="display:flex;"><span>                    rm -rf src
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/argument&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;/arguments&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;goals&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;goal&gt;</span>exec<span style="color:#f92672">&lt;/goal&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/goals&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;/execution&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;execution&gt;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#75715e">&lt;!-- Here we optionally create the final war file containing our rails app using warbler,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                     doing a small cleanup of the files and folders maven created  --&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;id&gt;</span>create-final-war<span style="color:#f92672">&lt;/id&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;phase&gt;</span>package<span style="color:#f92672">&lt;/phase&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;executable&gt;</span>/bin/sh<span style="color:#f92672">&lt;/executable&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;workingDirectory&gt;</span>.<span style="color:#f92672">&lt;/workingDirectory&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;arguments&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;argument&gt;</span>-c<span style="color:#f92672">&lt;/argument&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;argument&gt;</span>
</span></span><span style="display:flex;"><span>                   rm -rf *.war tmp/war
</span></span><span style="display:flex;"><span>                   jruby -S warble &amp;amp;&amp;amp; \
</span></span><span style="display:flex;"><span>                   mv *.war target/railsApp.war
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">&lt;/argument&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;/arguments&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/configuration&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;goals&gt;</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&lt;goal&gt;</span>exec<span style="color:#f92672">&lt;/goal&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;/goals&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">&lt;/execution&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/executions&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">&lt;/plugins&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/build&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/project&gt;</span>
</span></span></code></pre></div><p><br><br>Now from the command line we can just run <em>mvn package</em> and we&rsquo;re good to go.<br><br>Maven will start to package the application as a war file. Since it&rsquo;s not a Java application we create the empty web.xml file in the compile phase, to fool maven. <br><br><br>After it has copied all the dependencies into WEB-INF/lib the next packaging goals will make sure we copy them to our rails&rsquo; lib folder, also creating the final war file, ready for deployment.<br><br><br>Note that once done, you can use a simple code snippet similar to this one as an initializer and load all dependencies:<br><pre lang="ruby"><br>Dir.entries(&quot;#{RAILS_ROOT}/lib&quot;).sort.each do |entry|<br>  if entry =~ /.jar$/<br>    require entry<br>  end<br>end<br></pre><br><br>Then we can just use script/console, script/server and so on, as we normally would.<br><br>Sorry for the long post, I tried to pack in as much as I could and I certainly hope it&rsquo;s useful to someone. Any doubts, comments and etc&hellip; just drop me a line. :)</p>
    </div>
    <a href="/writings/2009/07/01/jruby-on-rails-and-legacy-java-apps-managing-dependencies/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2009/06/22/google-io-thoughtworks-on-gae/" class="link black dim">
        google io thoughtworks on gae
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
I've just watched a <a href="http://www.youtube.com/watch?v=-4fA_UciDaA">video</a> from <a href="http://code.google.com/events/io/">Google IO</a> where <a href="http://code.google.com/events/io/">Martin Fowler</a> and Rebecca Parsons went through some of the aspects that involves the development of an application for the cloud - focusing on the JVM.<br><br>In terms of the Google App Engine, you don't have access to a relational database, thing I found out <a href="http://www.leonardoborges.com/writings/2009/04/10/jruby-on-rails-and-google-app-engine/">when I first tried it</a>.  Instead you get a <a href="http://labs.google.com/papers/bigtable.html">Big Table</a>.<br><br>Martin put out a good analogy and you can just think of it as a nested hash map. It's certainly a shift on how we think these days, but layers of abstraction like google's DataStore and the Java Persistence API will help in the transition.<br><br>Another interesting bit about the presentation was on how concurrency works on GAE.<br><br>Essentially, in an standard Java application you have a single memory space where you have at least one running thread. You can create threads on the fly, which will share the same memory space, thus making it easy to share data.<br><br>On the app engine, things work differently. What you have are separate memory spaces with a single thread on each one. Any attempt to create a new thread will result in an exception. The solution for sharing information in this case? Use the nested hash map (big table).<br><br>Now, whereas you might not be worried about this since your application doesn't span any threads, as well pointed by Martin Fowler, it's the code you don't see that you need to be careful with. Any Java application uses a number of 3rd party libraries that might span out threads of their own, which will result in your application blowing up.<br><br>That rang a bell. Again, back when <a href="http://www.leonardoborges.com/writings/2009/04/10/jruby-on-rails-and-google-app-engine/">I was trying the app engine</a>, one of the configuration bits shared by <a href="http://olabini.com/blog/2009/04/jruby-on-rails-on-google-app-engine/">Ola Bini</a> looked like this:<br><pre>   config.webxml.jruby.min.runtimes = 1<br>   config.webxml.jruby.max.runtimes = 1<br>   config.webxml.jruby.init.serial = true</pre><br><br>I think the properties are pretty much self-explanatory but I didn't quite understand the reason for setting it back then.<br><br>If you happen to have bigger values for the number of runtimes you want, you need to set the serial property to true, otherwise JRuby will span several threads to create the runtimes.<br><br>This is a really good example of things that might fail whether you're migrating or developing a new app to deploy on the App Engine. Luckily for us, JRuby has a smart and neat way to handle this - the configuration I've just shown, but most of the libraries out there that might rely on threads are not prepared.<br><br>Martin and Rebecca's opinion on this is that new releases of these same libraries will start to take it into account, since a bigger adoption of the Cloud seem to be on the way.<br><br>Make sure you watch the video. I certainly left a lot of interesting stuff out.
</p>
    </div>
    <a href="/writings/2009/06/22/google-io-thoughtworks-on-gae/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2009/06/14/helping-the-jruby-effort-debugging-the-source/" class="link black dim">
        helping the jruby effort debugging the source
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>Wanna help improve JRuby? Make sure you read <a href="http://blog.headius.com/2009/05/help-jruby-by-fixing-rubyspecs.html" target="_blank">this</a> post by Charles Nutter first. There he explains how to run Ruby specs with JRuby.</p>
<p>Start with fixing Ruby specs is a great way to get acquainted with the code. And it&rsquo;s also a important task in order to make sure JRuby is the most complete and compatible ruby implementation out there.</p>
<p>But before you get your hands dirty, it will be a lot easier if you can actually debug JRuby&rsquo;s source while fixing any specs - or bugs/features for that matter.</p>
    </div>
    <a href="/writings/2009/06/14/helping-the-jruby-effort-debugging-the-source/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2009/05/29/railswaycon-jruby-internals-by-ola-bini/" class="link black dim">
        railswaycon jruby internals by ola bini
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
As always I expected a good talk from Ola and once more he delivered it. But this one was different. It might have been even boring to some ruby developers since we saw a fair amount of java code in this presentation. Ola gave us a tour through the main classes that make JRuby possible with a single purpose: so we can check out the code and hack ourselves. You can download his slides <a href="http://olabini.com/presentations/JRubyInternals.pdf" target="_blank">here</a>.<br><br>If you've been following both JRuby and Ola Bini for the past year or so, you've noticed the trend and evolution of this alternative - and so far the most complete one - implementation of the ruby language. Specially at conferences.<br><br>Last year at QCon London, Ola was also talking about JRuby. At Euruko '08, in Prague, <a href="http://blog.headius.com/" target="_blank">Charles Nutter</a> also talked about it. RailsConf in Berlin also had its share. What all these talks had in common is that they talked about JRuby from a user/developer point of view. They were selling the solution. Convincing people to use it and presenting successful use cases.<br><br>And as the trend goes on, JRuby is now faced as a true alternative - one that we, btw, believe here at the company as we're <strong>actively using it</strong> - and it seems that now the call is for help. Help to make JRuby an even more complete and overall better ruby implementation. Charles' <a href="http://blog.headius.com/2009/05/help-jruby-by-fixing-rubyspecs.html">call for help</a> was a great step. As he states, it's a good way to get your feet wet. I answered the call and am hacking JRuby myself, having already submitted a couple of patches. Perhaps this was the reason for which I enjoyed the talk the  most. I was already familiar with some of the structure and classes in JRuby.<br><br>There were 2 more talks about JRuby: <strong>The Pleasure and Pain of Migrating to jRuby</strong>, by <a href="http://twitter.com/stevenbristol" target="_blank">Steven Bristol</a> and <strong>Integrating Enterprise Java with JRuby and Rails</strong>, <a href="http://twitter.com/malagant" target="_blank">Michael Johann</a>. Unfortunately only the first one was a real case experience, where Steven walked through the problems he faced integrating JRuby with an existing java project. Interesting insights.<br><br>Michael Johann basically presented a short tutorial on how to integrate rails with EJB3 which, albeit interesting, failed to address issues faced on real life projects, like dependency management. Issues which we have already addressed in a very cool way here and I plan to share it soon. Still deciding how though...
</p>
    </div>
    <a href="/writings/2009/05/29/railswaycon-jruby-internals-by-ola-bini/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2009/05/05/rcov-jruby-and-rcov_plugin/" class="link black dim">
        rcov jruby and rcov_plugin
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
The <a href="http://github.com/commondream/rcov_plugin/tree/master" target="_blank">rcov_plugin</a> project is a rails plugin for <a href="http://eigenclass.org/hiki.rb?rcov" target="_blank">rcov</a> that adds some useful rake tasks to your application.  And since I'm currently working in a JRuby project it made sense to use this plugin.<br><br>The thing is, among other stuff, an rcov report from a JRuby project includes some files that shouldn't be there at all, plus you also need to change the way you call rcov as such. Thus, I thought I'd contribute these changes to the plugin and my pull request was approved this morning - just install the latest version and you should be good to go.<br><br>It was useful for us here, hope it might be useful for you too.<br><br>Enjoy :)
</p>
    </div>
    <a href="/writings/2009/05/05/rcov-jruby-and-rcov_plugin/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2009/04/10/jruby-on-rails-and-google-app-engine/" class="link black dim">
        jruby on rails and google app engine
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
As many of you know the new language supported at <a href="http://code.google.com/appengine/" target="_blank">GAE</a> now is Java, as officially announced on their <a href="http://googleappengine.blogspot.com/2009/04/seriously-this-time-new-language-on-app.html" target="_blank">blog</a>. As a Ruby/Rails developer you might not be interested on it but here is a reason you should be: <a href="http://jruby.codehaus.org/" target="_blank">JRuby</a>.<br><br>It was only a matter of time until we saw some people deploying JRuby on Rails apps on GAE, like Ola Bini's <a href="http://olabini.com/blog/2009/04/jruby-on-rails-on-google-app-engine/" target="_blank">mini blog app</a>. Guess that was the first one really, as he was beta testing the service in secret. Google App Engine imposes a few catches to any java application deployed there and any JRuby app wouldn't be different. For instance, your Java API access is limited to <a href="http://code.google.com/appengine/docs/java/jrewhitelist.html" target="_blank">these classes - called JRE Class whitelist</a>.<br><br>As you can see on his blog, you don't need active record and in fact shouldn't even be loading that on your app.<br><br>I felt compelled to try it and the timing was perfect. I am currently developing a JRuby on Rails app at the company I work for and it was a perfect fit, since we are not using ActiveRecord. The reason is that we get the data we need from other sources, such as web services and even text files.<br><br>Ola Bini's tips were crucial here. He provides a small script you can use to prepare the jars you're sending to your app. Another important piece was the <a href="http://code.google.com/appengine/downloads.html#Google_App_Engine_SDK_for_Java" target="_blank">Google App Engine SDK for Java</a>. It ships with a server that emulates GAE's behaviour locally so you're less likely to have problems once you deploy it.<br><br>I did have a problem though with the number of files uploaded to my appspot. It's currently limited to 1000 - a thousand - and a Rails app can easily exceed this limit. So before deploying, remove anything that is not crucial: activerecord - you should've done it already - , all tests directories - including the ones inside gems your app needs in order to work, fixtures and etc.<br><br>After that it was rewarding seeing a custom JRuby On Rails application working perfectly on GAE. And as much as I'd like to, I can't really share the URL since it's a private app but I encourage people to try it. I believe GAE will ultimately help the community improve JRuby even more.<br><br>And as a last tip, this time thanks to <a href="http://akitaonrails.com/" target="_blank">Fabio Akita</a>, is <a href="http://gist.github.com/91684" target="_blank">this snippet</a>. You should redirect your log so you can debug your app form GAE's dashboard.<br><br>Have fun!
</p>
    </div>
    <a href="/writings/2009/04/10/jruby-on-rails-and-google-app-engine/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2008/04/07/jruby-db2-xquery-bug/" class="link black dim">
        jruby db2 xquery bug
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
<strong>Update</strong>: Follow up link to this issue on JRuby's Jira, <a href="http://jira.codehaus.org/browse/JRUBY-2430">here</a><br><br>As I told in my last <a href="http://leonardoborges.com/writings/2008/04/04/qcon-2008-slides-available/">post</a>, it was time to give JRuby a serious try. So I took one of our rails projects at work and decided to migrate it to JRuby and see what happens.<br><br>We heavily use the XML capabilities of DB2 and this was a huge problem. Every query would work just fine through the activerecord-jdbc-adapter - part of the <a href="http://rubyforge.org/projects/jruby-extras">JRuby Extras</a> . But every <strong>X</strong>query would gracefully <strong>fail</strong>!<br><br>After some debugging I got stuck and decided to get JRuby and activerecord-jdbc-adapter's source to see what was happening.<br><br>As I could see, it has a bug -in my opinion - at the java part of the code. The jdbc-adapter is a bridge to allow Active Record to talk with databases through native JDBC drivers, so it's normal that we do have a java part here. At this point, what the code does is to inspect the sql statement sent from ruby and decide if it's a select, update or insert.<br><br>I fixed the problem and submitted a <a href="http://rubyforge.org/tracker/index.php?func=detail&amp;aid=19340&amp;group_id=2014&amp;atid=7859">patch</a> to rubyforge. I'm not sure if it's the best solution or not, but now I got the xQueries working just fine.<br><br>I'd love to hear from people with similar environments whether this patch works for you or not. I'm sure I didn't try every possibility.<br><br>If you wanna try it, just drop me a message (e-mail in the <a href="http://leonardoborges.com/writings/about/">About</a> page) and I can send the pre-compiled jar file - for activerecord-jdbc-0.8<br><br>You can also just check out the code and compile yourself. ;)
</p>
    </div>
    <a href="/writings/2008/04/07/jruby-db2-xquery-bug/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
        <div class="relative w-100  mb4 bg-white">
          <div class="relative w-100 mb4 bg-white nested-copy-line-height">
  <div class="bg-white mb3 pa4 gray overflow-hidden">
    <span class="f6 db">Writings</span>
    <h1 class="f3 near-black">
      <a href="/writings/2008/04/04/qcon-2008-slides-available/" class="link black dim">
        qcon 2008 slides available
      </a>
    </h1>
    <div class="nested-links f5 lh-copy nested-copy-line-height">
      <p>
Most of last QCon's presentations are available for download <a href="http://jaoo.dk/london-2008/schedule">here</a>.<br><br>Highlights to Ola Bini's on <a href="http://jaoo.dk/london-2008/file?path=/qcon-london-2008/slides/OlaBini_JRuby_Power_on_the_JVM.pdf">JRuby(pdf)</a> and Randy Shoup's on  <a href="http://jaoo.dk/london-2008/file?path=/qcon-london-2008/slides/RandyShoup_eBaysArchitecturalPrinciples.pdf">eBay's architectural principles(pdf)</a>.<br><br>And while we're talking about JRuby, it's impressive how it's becoming a recurrent and big subject. Fast. It had its own small space at big event like QCon and in the last Euruko in Prague, we had a presentation by the JRuby Core Developers <a href="http://headius.blogspot.com/">Charles Nutter</a> and <a href="http://www.bloglines.com/blog/ThomasEEnebo">Thomas Enebo</a>.<br><br>Big companies are sponsoring JRuby's development indirectly or directly, like <a href="http://www.sun.com">Sun</a>. And other big companies are endorsing its production ready state, like <a href="http://www.oracle.com">Oracle</a>, which has a publicly available website developed with JRuby On Rails.<br><br>It's past the time to give it a serious try...
</p>
    </div>
    <a href="/writings/2008/04/04/qcon-2008-slides-available/" class="ba b--moon-gray bg-light-gray br2 color-inherit dib f7 hover-bg-moon-gray link mt2 ph2 pv1">read more</a>
  </div>
</div>

        </div>
      
    </section>
  </div>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://leonardoborges.com/" >
    &copy;  Leonardo Borges 2025 
  </a>
    <div><div class="ananke-socials"><a href="https://github.com/theleoborges/" target="_blank" rel="noopener"
        class="ananke-social-link link-transition github link dib z-999 pt3 pt0-l mr1"
        title="follow on GitHub - Opens in a new window"
        aria-label="follow on GitHub - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
            
          </span></a><a href="https://twitter.com/theleoborges" target="_blank" rel="noopener"
        class="ananke-social-link link-transition twitter link dib z-999 pt3 pt0-l mr1"
        title="follow on Twitter - Opens in a new window"
        aria-label="follow on Twitter - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
            
          </span></a><a href="http://linkedin.com/in/theleoborges" target="_blank" rel="noopener"
        class="ananke-social-link link-transition linkedin link dib z-999 pt3 pt0-l mr1"
        title="follow on LinkedIn - Opens in a new window"
        aria-label="follow on LinkedIn - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
            
          </span></a></div>
</div>
  </div>
</footer>

  </body>
</html>
