<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>refactoring for readability | Leonardo Borges</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="
Yesterday I&#39;ve done something I should do more often: Revisit some code written a while ago for our current project and make it better.Let&#39;s face it. We all write crappy code the 1st time. The difference is in what we do about it afterwards.We might decide it&#39;s good enough and keep moving, or we could (and should!) stop and refactor it!The code I revisited worked as a refactoring exercise and it&#39;s initial version is shown below:
class Jphoto
 ...

 #a few other methods ...

 def post_photo(file_data, hotel_id, send_rss, options = {})
   file_name = &#34;tmp/#{Time.now.to_i}_#{rand(1000000).to_s(36)}&#34;
   File.open(file_name, &#34;wb&#34;) do |f|
     f.puts(file_data)
   end

   params = [Curl::PostField.file(&#39;photo&#39;,file_name),
      Curl::PostField.content(&#39;hotel&#39;, hotel_id),
      Curl::PostField.content(&#39;source&#39;,&#39;PhotoUploadTest&#39;)]
   extract_extra_params!(params, options)

   c = Curl::Easy.new(&#34;#{service_uri_base}/photoupld&#34;)
   c.multipart_form_post = true
   c.http_post(*params)

   if c.response_code != 200
     error_msg = &#34;File upload failed with code: #{c.response_code}&#34;
     Rails.logger.info error_msg
     raise error_msg
   end

   File.delete(file_name)

   hotel = Hotel.find_by_id(hotel_id)
   hotel.cache.destroy_all

   send_upload_rss(hotel, original_upload_url(c.body_str) , options) if send_rss
 end

 private

 def send_upload_rss(hotel, photo_url, options)
   ...
 end
 def manage_images_link(hotel_id)
   ...
 end

 def extract_extra_params!(params, options)
   params &lt;&lt; Curl::PostField.content(&#39;status&#39;, options[:status]) if options[:status]
   params &lt;&lt; Curl::PostField.content(&#39;upload_source&#39;, options[:upload_source]) if options[:upload_source]
   params &lt;&lt; Curl::PostField.content(&#39;uploader_ip&#39;, options[:uploader_ip]) if options[:uploader_ip]
   params &lt;&lt; Curl::PostField.content(&#39;uploader_email&#39;, options[:uploader_email]) if options[:uploader_email]
 end
end
Look at the post_photo method. It has problems in so many levels that it&rsquo;s hard to start. Methods should do &ldquo;one thing&rdquo; and that method obviously does much more than that, mixing different levels of abstraction.But let&rsquo;s start with the easy parts first, keeping in mind that I was aiming for readability.Lines 7 to 10 seem to be there just to make the reader&rsquo;s life harder. It&rsquo;s creating a temporary file through some custom logic instead of using the tools provided by the language. Unnecessary and only pollutes our eyes. My first measure was to use ruby&rsquo;s TempFile class for this. Better, but we still have a long way.Right at line 12 it creates some sort of default parameters list, after which it extracts some extra options. I don&rsquo;t know what that method does but it&rsquo;s clearly using output arguments, which we should avoid at all costs, as they lead to confusion. This is a big smell as well, and another refactoring step added to my list.On line 21 starts the code that handles what to do when we get a response_code other than 200 from our request. Apart from the fact that this code doesn&rsquo;t feel right here, we just happen to know that in HTTP, 200 means success, but that might not be clear to someone looking at the code for the 1st time.Then the code goes on to delete the temp file, clear the hotel&rsquo;s cache and send the rss if the rss&rsquo; flag is true.Let there be refactoring&hellip;.Geez, how many lines have I used to explain what the code does? Since I don&rsquo;t wanna bore you to death, here is my refactored version of this method, trying to avoid as much as I can the problems I highlighted previously:">
    <meta name="generator" content="Hugo 0.139.4">
    
    
    
      <meta name="robots" content="index, follow">
    
    

    
<link rel="stylesheet" href="/ananke/css/main.min.1a1e856c575c37c0a14fa63fe637fefcac5fc8a9e372c7d8de0184b5ab217407.css" >



    

    
      
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />


    

    

    
      <link rel="canonical" href="http://leonardoborges.com/writings/2009/09/18/refactoring-for-readability/">
    

    <meta property="og:url" content="http://leonardoborges.com/writings/2009/09/18/refactoring-for-readability/">
  <meta property="og:site_name" content="Leonardo Borges">
  <meta property="og:title" content="refactoring for readability">
  <meta property="og:description" content="Yesterday I&#39;ve done something I should do more often: Revisit some code written a while ago for our current project and make it better.
Let&#39;s face it. We all write crappy code the 1st time. The difference is in what we do about it afterwards.
We might decide it&#39;s good enough and keep moving, or we could (and should!) stop and refactor it!
The code I revisited worked as a refactoring exercise and it&#39;s initial version is shown below: class Jphoto ... #a few other methods ... def post_photo(file_data, hotel_id, send_rss, options = {}) file_name = &#34;tmp/#{Time.now.to_i}_#{rand(1000000).to_s(36)}&#34; File.open(file_name, &#34;wb&#34;) do |f| f.puts(file_data) end params = [Curl::PostField.file(&#39;photo&#39;,file_name), Curl::PostField.content(&#39;hotel&#39;, hotel_id), Curl::PostField.content(&#39;source&#39;,&#39;PhotoUploadTest&#39;)] extract_extra_params!(params, options) c = Curl::Easy.new(&#34;#{service_uri_base}/photoupld&#34;) c.multipart_form_post = true c.http_post(*params) if c.response_code != 200 error_msg = &#34;File upload failed with code: #{c.response_code}&#34; Rails.logger.info error_msg raise error_msg end File.delete(file_name) hotel = Hotel.find_by_id(hotel_id) hotel.cache.destroy_all send_upload_rss(hotel, original_upload_url(c.body_str) , options) if send_rss end private def send_upload_rss(hotel, photo_url, options) ... end def manage_images_link(hotel_id) ... end def extract_extra_params!(params, options) params &lt;&lt; Curl::PostField.content(&#39;status&#39;, options[:status]) if options[:status] params &lt;&lt; Curl::PostField.content(&#39;upload_source&#39;, options[:upload_source]) if options[:upload_source] params &lt;&lt; Curl::PostField.content(&#39;uploader_ip&#39;, options[:uploader_ip]) if options[:uploader_ip] params &lt;&lt; Curl::PostField.content(&#39;uploader_email&#39;, options[:uploader_email]) if options[:uploader_email] end end Look at the post_photo method. It has problems in so many levels that it’s hard to start. Methods should do “one thing” and that method obviously does much more than that, mixing different levels of abstraction.
But let’s start with the easy parts first, keeping in mind that I was aiming for readability.
Lines 7 to 10 seem to be there just to make the reader’s life harder. It’s creating a temporary file through some custom logic instead of using the tools provided by the language. Unnecessary and only pollutes our eyes. My first measure was to use ruby’s TempFile class for this. Better, but we still have a long way.
Right at line 12 it creates some sort of default parameters list, after which it extracts some extra options. I don’t know what that method does but it’s clearly using output arguments, which we should avoid at all costs, as they lead to confusion. This is a big smell as well, and another refactoring step added to my list.
On line 21 starts the code that handles what to do when we get a response_code other than 200 from our request. Apart from the fact that this code doesn’t feel right here, we just happen to know that in HTTP, 200 means success, but that might not be clear to someone looking at the code for the 1st time.
Then the code goes on to delete the temp file, clear the hotel’s cache and send the rss if the rss’ flag is true.
Let there be refactoring….
Geez, how many lines have I used to explain what the code does? Since I don’t wanna bore you to death, here is my refactored version of this method, trying to avoid as much as I can the problems I highlighted previously:">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writings">
    <meta property="article:published_time" content="2009-09-18T00:00:00+00:00">
    <meta property="article:modified_time" content="2009-09-18T00:00:00+00:00">
    <meta property="article:tag" content="JRuby">
    <meta property="article:tag" content="Refactoring">
    <meta property="article:tag" content="Ruby">

  <meta itemprop="name" content="refactoring for readability">
  <meta itemprop="description" content="Yesterday I&#39;ve done something I should do more often: Revisit some code written a while ago for our current project and make it better.
Let&#39;s face it. We all write crappy code the 1st time. The difference is in what we do about it afterwards.
We might decide it&#39;s good enough and keep moving, or we could (and should!) stop and refactor it!
The code I revisited worked as a refactoring exercise and it&#39;s initial version is shown below: class Jphoto ... #a few other methods ... def post_photo(file_data, hotel_id, send_rss, options = {}) file_name = &#34;tmp/#{Time.now.to_i}_#{rand(1000000).to_s(36)}&#34; File.open(file_name, &#34;wb&#34;) do |f| f.puts(file_data) end params = [Curl::PostField.file(&#39;photo&#39;,file_name), Curl::PostField.content(&#39;hotel&#39;, hotel_id), Curl::PostField.content(&#39;source&#39;,&#39;PhotoUploadTest&#39;)] extract_extra_params!(params, options) c = Curl::Easy.new(&#34;#{service_uri_base}/photoupld&#34;) c.multipart_form_post = true c.http_post(*params) if c.response_code != 200 error_msg = &#34;File upload failed with code: #{c.response_code}&#34; Rails.logger.info error_msg raise error_msg end File.delete(file_name) hotel = Hotel.find_by_id(hotel_id) hotel.cache.destroy_all send_upload_rss(hotel, original_upload_url(c.body_str) , options) if send_rss end private def send_upload_rss(hotel, photo_url, options) ... end def manage_images_link(hotel_id) ... end def extract_extra_params!(params, options) params &lt;&lt; Curl::PostField.content(&#39;status&#39;, options[:status]) if options[:status] params &lt;&lt; Curl::PostField.content(&#39;upload_source&#39;, options[:upload_source]) if options[:upload_source] params &lt;&lt; Curl::PostField.content(&#39;uploader_ip&#39;, options[:uploader_ip]) if options[:uploader_ip] params &lt;&lt; Curl::PostField.content(&#39;uploader_email&#39;, options[:uploader_email]) if options[:uploader_email] end end Look at the post_photo method. It has problems in so many levels that it’s hard to start. Methods should do “one thing” and that method obviously does much more than that, mixing different levels of abstraction.
But let’s start with the easy parts first, keeping in mind that I was aiming for readability.
Lines 7 to 10 seem to be there just to make the reader’s life harder. It’s creating a temporary file through some custom logic instead of using the tools provided by the language. Unnecessary and only pollutes our eyes. My first measure was to use ruby’s TempFile class for this. Better, but we still have a long way.
Right at line 12 it creates some sort of default parameters list, after which it extracts some extra options. I don’t know what that method does but it’s clearly using output arguments, which we should avoid at all costs, as they lead to confusion. This is a big smell as well, and another refactoring step added to my list.
On line 21 starts the code that handles what to do when we get a response_code other than 200 from our request. Apart from the fact that this code doesn’t feel right here, we just happen to know that in HTTP, 200 means success, but that might not be clear to someone looking at the code for the 1st time.
Then the code goes on to delete the temp file, clear the hotel’s cache and send the rss if the rss’ flag is true.
Let there be refactoring….
Geez, how many lines have I used to explain what the code does? Since I don’t wanna bore you to death, here is my refactored version of this method, trying to avoid as much as I can the problems I highlighted previously:">
  <meta itemprop="datePublished" content="2009-09-18T00:00:00+00:00">
  <meta itemprop="dateModified" content="2009-09-18T00:00:00+00:00">
  <meta itemprop="wordCount" content="861">
  <meta itemprop="keywords" content="JRuby,Refactoring,Ruby">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="refactoring for readability">
  <meta name="twitter:description" content="Yesterday I&#39;ve done something I should do more often: Revisit some code written a while ago for our current project and make it better.
Let&#39;s face it. We all write crappy code the 1st time. The difference is in what we do about it afterwards.
We might decide it&#39;s good enough and keep moving, or we could (and should!) stop and refactor it!
The code I revisited worked as a refactoring exercise and it&#39;s initial version is shown below: class Jphoto ... #a few other methods ... def post_photo(file_data, hotel_id, send_rss, options = {}) file_name = &#34;tmp/#{Time.now.to_i}_#{rand(1000000).to_s(36)}&#34; File.open(file_name, &#34;wb&#34;) do |f| f.puts(file_data) end params = [Curl::PostField.file(&#39;photo&#39;,file_name), Curl::PostField.content(&#39;hotel&#39;, hotel_id), Curl::PostField.content(&#39;source&#39;,&#39;PhotoUploadTest&#39;)] extract_extra_params!(params, options) c = Curl::Easy.new(&#34;#{service_uri_base}/photoupld&#34;) c.multipart_form_post = true c.http_post(*params) if c.response_code != 200 error_msg = &#34;File upload failed with code: #{c.response_code}&#34; Rails.logger.info error_msg raise error_msg end File.delete(file_name) hotel = Hotel.find_by_id(hotel_id) hotel.cache.destroy_all send_upload_rss(hotel, original_upload_url(c.body_str) , options) if send_rss end private def send_upload_rss(hotel, photo_url, options) ... end def manage_images_link(hotel_id) ... end def extract_extra_params!(params, options) params &lt;&lt; Curl::PostField.content(&#39;status&#39;, options[:status]) if options[:status] params &lt;&lt; Curl::PostField.content(&#39;upload_source&#39;, options[:upload_source]) if options[:upload_source] params &lt;&lt; Curl::PostField.content(&#39;uploader_ip&#39;, options[:uploader_ip]) if options[:uploader_ip] params &lt;&lt; Curl::PostField.content(&#39;uploader_email&#39;, options[:uploader_email]) if options[:uploader_email] end end Look at the post_photo method. It has problems in so many levels that it’s hard to start. Methods should do “one thing” and that method obviously does much more than that, mixing different levels of abstraction.
But let’s start with the easy parts first, keeping in mind that I was aiming for readability.
Lines 7 to 10 seem to be there just to make the reader’s life harder. It’s creating a temporary file through some custom logic instead of using the tools provided by the language. Unnecessary and only pollutes our eyes. My first measure was to use ruby’s TempFile class for this. Better, but we still have a long way.
Right at line 12 it creates some sort of default parameters list, after which it extracts some extra options. I don’t know what that method does but it’s clearly using output arguments, which we should avoid at all costs, as they lead to confusion. This is a big smell as well, and another refactoring step added to my list.
On line 21 starts the code that handles what to do when we get a response_code other than 200 from our request. Apart from the fact that this code doesn’t feel right here, we just happen to know that in HTTP, 200 means success, but that might not be clear to someone looking at the code for the 1st time.
Then the code goes on to delete the temp file, clear the hotel’s cache and send the rss if the rss’ flag is true.
Let there be refactoring….
Geez, how many lines have I used to explain what the code does? Since I don’t wanna bore you to death, here is my refactored version of this method, trying to avoid as much as I can the problems I highlighted previously:">

      
    
	
  </head><body class="ma0 avenir bg-near-white production">

    
   
  

<header>
    <div class="bg-black">
        <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Leonardo Borges
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/books/" title="Books page">
              Books
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://leonardoborges.substack.com/p/leadership-coaching" title="Coaching page">
              Coaching
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://leonardoborges.substack.com/" title="Newsletter page">
              Newsletter
            </a>
          </li>
          
        </ul>
      
      <div class="ananke-socials"><a href="https://github.com/theleoborges/" target="_blank" rel="noopener"
        class="ananke-social-link link-transition github link dib z-999 pt3 pt0-l mr1"
        title="follow on GitHub - Opens in a new window"
        aria-label="follow on GitHub - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
            
          </span></a><a href="https://twitter.com/theleoborges" target="_blank" rel="noopener"
        class="ananke-social-link link-transition twitter link dib z-999 pt3 pt0-l mr1"
        title="follow on Twitter - Opens in a new window"
        aria-label="follow on Twitter - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
            
          </span></a><a href="http://linkedin.com/in/theleoborges" target="_blank" rel="noopener"
        class="ananke-social-link link-transition linkedin link dib z-999 pt3 pt0-l mr1"
        title="follow on LinkedIn - Opens in a new window"
        aria-label="follow on LinkedIn - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
            
          </span></a></div>

    </div>
  </div>
</nav>

    </div>
    
</header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        Writings
      </aside><div id="sharing" class="mt3 ananke-socials"></div>
<h1 class="f1 athelas mt3 mb1">refactoring for readability</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2009-09-18T00:00:00Z">September 18, 2009</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p>
Yesterday I've done something I should do more often: Revisit some code written a while ago for our current project and make it better.<br><br>Let's face it. We all write crappy code the 1st time. The difference is in what we do about it afterwards.<br>We might decide it's good enough and keep moving, or we could (and should!) stop and refactor it!<br><br>The code I revisited worked as a refactoring exercise and it's initial version is shown below:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jphoto</span>
</span></span><span style="display:flex;"><span> <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#75715e">#a few other methods ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">post_photo</span>(file_data, hotel_id, send_rss, options <span style="color:#f92672">=</span> {})
</span></span><span style="display:flex;"><span>   file_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;tmp/</span><span style="color:#e6db74">#{</span><span style="color:#66d9ef">Time</span><span style="color:#f92672">.</span>now<span style="color:#f92672">.</span>to_i<span style="color:#e6db74">}</span><span style="color:#e6db74">_</span><span style="color:#e6db74">#{</span>rand(<span style="color:#ae81ff">1000000</span>)<span style="color:#f92672">.</span>to_s(<span style="color:#ae81ff">36</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">File</span><span style="color:#f92672">.</span>open(file_name, <span style="color:#e6db74">&#34;wb&#34;</span>) <span style="color:#66d9ef">do</span> <span style="color:#f92672">|</span>f<span style="color:#f92672">|</span>
</span></span><span style="display:flex;"><span>     f<span style="color:#f92672">.</span>puts(file_data)
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>file(<span style="color:#e6db74">&#39;photo&#39;</span>,file_name),
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;hotel&#39;</span>, hotel_id),
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;source&#39;</span>,<span style="color:#e6db74">&#39;PhotoUploadTest&#39;</span>)<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   extract_extra_params!(params, options)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   c <span style="color:#f92672">=</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Easy</span><span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">#{</span>service_uri_base<span style="color:#e6db74">}</span><span style="color:#e6db74">/photoupld&#34;</span>)
</span></span><span style="display:flex;"><span>   c<span style="color:#f92672">.</span>multipart_form_post <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>   c<span style="color:#f92672">.</span>http_post(<span style="color:#f92672">*</span>params)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span> c<span style="color:#f92672">.</span>response_code <span style="color:#f92672">!=</span> <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>     error_msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;File upload failed with code: </span><span style="color:#e6db74">#{</span>c<span style="color:#f92672">.</span>response_code<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">Rails</span><span style="color:#f92672">.</span>logger<span style="color:#f92672">.</span>info error_msg
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">raise</span> error_msg
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">File</span><span style="color:#f92672">.</span>delete(file_name)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   hotel <span style="color:#f92672">=</span> <span style="color:#66d9ef">Hotel</span><span style="color:#f92672">.</span>find_by_id(hotel_id)
</span></span><span style="display:flex;"><span>   hotel<span style="color:#f92672">.</span>cache<span style="color:#f92672">.</span>destroy_all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   send_upload_rss(hotel, original_upload_url(c<span style="color:#f92672">.</span>body_str) , options) <span style="color:#66d9ef">if</span> send_rss
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">private</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_upload_rss</span>(hotel, photo_url, options)
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">manage_images_link</span>(hotel_id)
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">extract_extra_params!</span>(params, options)
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;status&#39;</span>, options<span style="color:#f92672">[</span><span style="color:#e6db74">:status</span><span style="color:#f92672">]</span>) <span style="color:#66d9ef">if</span> options<span style="color:#f92672">[</span><span style="color:#e6db74">:status</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;upload_source&#39;</span>, options<span style="color:#f92672">[</span><span style="color:#e6db74">:upload_source</span><span style="color:#f92672">]</span>) <span style="color:#66d9ef">if</span> options<span style="color:#f92672">[</span><span style="color:#e6db74">:upload_source</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;uploader_ip&#39;</span>, options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_ip</span><span style="color:#f92672">]</span>) <span style="color:#66d9ef">if</span> options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_ip</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   params <span style="color:#f92672">&lt;&lt;</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">PostField</span><span style="color:#f92672">.</span>content(<span style="color:#e6db74">&#39;uploader_email&#39;</span>, options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_email</span><span style="color:#f92672">]</span>) <span style="color:#66d9ef">if</span> options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_email</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p><br>Look at the post_photo method. It has problems in so many levels that it&rsquo;s hard to start. <br>Methods should do &ldquo;one thing&rdquo; and that method obviously does much more than that, mixing different levels of abstraction.<br><br>But let&rsquo;s start with the easy parts first, keeping in mind that I was aiming for readability.<br><br>Lines 7 to 10 seem to be there just to make the reader&rsquo;s life harder. It&rsquo;s creating a temporary file through some custom logic instead of using the tools provided by the language. Unnecessary and only pollutes our eyes. My first measure was to use ruby&rsquo;s TempFile class for this. Better, but we still have a long way.<br><br>Right at line 12 it creates some sort of default parameters list, after which it extracts some extra options. I don&rsquo;t know what that method does but it&rsquo;s clearly using output arguments, which we should avoid at all costs, as they lead to confusion. This is a big smell as well, and another refactoring step added to my list.<br><br>On line 21 starts the code that handles what to do when we get a response_code other than 200 from our request. Apart from the fact that this code doesn&rsquo;t feel right here, we just happen to know that in HTTP, 200 means success, but that might not be clear to someone looking at the code for the 1st time.<br><br>Then the code goes on to delete the temp file, clear the hotel&rsquo;s cache and send the rss if the rss&rsquo; flag is true.<br><br><strong>Let there be refactoring&hellip;.</strong><br><br>Geez, how many lines have I used to explain what the code does? Since I don&rsquo;t wanna bore you to death, here is my refactored version of this method, trying to avoid as much as I can the problems I highlighted previously:<br><br><br><br></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jphoto</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">SUCCESS</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#a few other methods ...</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">post_photo</span>(file_data, hotel_id, send_rss, options <span style="color:#f92672">=</span> {})
</span></span><span style="display:flex;"><span>    response_body <span style="color:#f92672">=</span> make_post_request(file_data, hotel_id, options)
</span></span><span style="display:flex;"><span>    hotel <span style="color:#f92672">=</span> <span style="color:#66d9ef">Hotel</span><span style="color:#f92672">.</span>find_by_id(hotel_id)
</span></span><span style="display:flex;"><span>    hotel<span style="color:#f92672">.</span>cache<span style="color:#f92672">.</span>destroy_all
</span></span><span style="display:flex;"><span>    send_upload_rss(hotel, original_upload_url(response_body) , options) <span style="color:#66d9ef">if</span> send_rss
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">...</span>
</span></span></code></pre></div><p>Ha! That reads much nicer, right?
Below you&rsquo;ll find the rest of the class, properly refactored. Note how I also changed the order of the private methods so the class has a reading flow.
You can now read it top down, without scrolling through the file several times trying to find where the methods are defined.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">make_post_request</span>(file_data, hotel_id, options)
</span></span><span style="display:flex;"><span>    temp_file <span style="color:#f92672">=</span> <span style="color:#66d9ef">Tempfile</span><span style="color:#f92672">.</span>open(<span style="color:#e6db74">&#39;minisite_upload_&#39;</span>)
</span></span><span style="display:flex;"><span>    temp_file<span style="color:#f92672">.</span>puts(file_data)
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> <span style="color:#66d9ef">Curl</span><span style="color:#f92672">::</span><span style="color:#66d9ef">Easy</span><span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">#{</span>service_uri_base<span style="color:#e6db74">&#39;]}/photoupld&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    c.multipart_form_post = true
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    c.http_post(*build_params_list(temp_file.path, hotel_id, options))
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    temp_file.delete
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    raise_and_log_error(&#34;File upload failed with code: #{c.response_code}&#34;) if c.response_code != SUCCESS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    c.body_str
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  end
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  def build_params_list(file_path, hotel_id, options)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    params = [Curl::PostField.file(&#39;</span>photo<span style="color:#e6db74">&#39;, file_path), Curl::PostField.content(&#39;</span>hotel<span style="color:#e6db74">&#39;, hotel_id), Curl::PostField.content(&#39;</span>source<span style="color:#e6db74">&#39;,&#39;</span><span style="color:#66d9ef">PhotoUploadTest</span><span style="color:#e6db74">&#39;)]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    params &lt;&lt; Curl::PostField.content(&#39;</span>status<span style="color:#e6db74">&#39;, options[:status]) if options[:status]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    params &lt;&lt; Curl::PostField.content(&#39;</span>upload_source<span style="color:#e6db74">&#39;, options[:upload_source]) if options[:upload_source]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    params &lt;&lt; Curl::PostField.content(&#39;</span>uploader_ip<span style="color:#e6db74">&#39;, options[:uploader_ip]) if options[:uploader_ip]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    params &lt;&lt; Curl::PostField.content(&#39;</span>uploader_email<span style="color:#960050;background-color:#1e0010">&#39;</span>, options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_email</span><span style="color:#f92672">]</span>) <span style="color:#66d9ef">if</span> options<span style="color:#f92672">[</span><span style="color:#e6db74">:uploader_email</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    params
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">raise_and_log_error</span>(error_msg)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">Rails</span><span style="color:#f92672">.</span>logger<span style="color:#f92672">.</span>info error_msg
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">raise</span> error_msg
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">original_upload_url</span>(jphotos_response)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_upload_rss</span>(hotel, photo_url, options)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">manage_images_link</span>(hotel_id)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>I&rsquo;ve only applied 2 basic principles to this code: That methods should do one thing and that they should avoid output arguments. But the result was a drastic improvement over the old code.
<strong>A last step&hellip;</strong>
There is still one thing I would like to change in the post_photo method. It takes a boolean as an argument. The first time you see a call to this method, there is no way you can tell what that flag is used for:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>  jphoto<span style="color:#f92672">.</span>post_photo(file_data, <span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">false</span>, options)
</span></span></code></pre></div><p>To make it more clear we could refactor the method once more to look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">post_photo_and_send_rss</span>(file_data, hotel_id, options <span style="color:#f92672">=</span> {})
</span></span><span style="display:flex;"><span>    response_body <span style="color:#f92672">=</span> post_photo(file_data, hotel_id, options)
</span></span><span style="display:flex;"><span>    send_upload_rss(hotel, original_upload_url(response_body) , options)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">post_photo</span>(file_data, hotel_id, options <span style="color:#f92672">=</span> {})
</span></span><span style="display:flex;"><span>    response_body <span style="color:#f92672">=</span> make_post_request(file_data, hotel_id, options)
</span></span><span style="display:flex;"><span>    hotel <span style="color:#f92672">=</span> <span style="color:#66d9ef">Hotel</span><span style="color:#f92672">.</span>find_by_id(hotel_id)
</span></span><span style="display:flex;"><span>    hotel<span style="color:#f92672">.</span>cache<span style="color:#f92672">.</span>destroy_all
</span></span><span style="display:flex;"><span>    response_body
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>This way we avoid an extra parameter and save our reader - and possibly us - of the trouble to guess what that flag was for.<br><br><br>I am by no means saying this is the definitive refactored state of this code but instead sharing the steps I went through while refactoring it. As always, tips and comments are welcome! :)</p>
</p>
<ul class="pa0">
  
   <li class="list di">
     <a href="/tags/jruby/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">JRuby</a>
   </li>
  
   <li class="list di">
     <a href="/tags/refactoring/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Refactoring</a>
   </li>
  
   <li class="list di">
     <a href="/tags/ruby/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Ruby</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
        <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "leonardoborges" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="/writings/2009/09/03/rails-summit-2009-im-speaking/">rails summit 2009 im speaking</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/07/31/jvm-language-preferences-poll-results/">jvm language preferences poll results</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/06/14/helping-the-jruby-effort-debugging-the-source/">helping the jruby effort debugging the source</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/05/29/railswaycon-jruby-internals-by-ola-bini/">railswaycon jruby internals by ola bini</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2008/04/07/jruby-db2-xquery-bug/">jruby db2 xquery bug</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2008/04/04/qcon-2008-slides-available/">qcon 2008 slides available</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/08/25/rails-rumble-09/">rails rumble 09</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/07/22/procs-lambdas-blocks-whats-the-difference/">procs lambdas blocks whats the difference</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/07/01/jruby-on-rails-and-legacy-java-apps-managing-dependencies/">jruby on rails and legacy java apps managing dependencies</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/06/22/google-io-thoughtworks-on-gae/">google io thoughtworks on gae</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/05/16/rails-readable-test-names-run-individual-tests-from-the-console/">rails readable test names run individual tests from the console</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/05/05/rcov-jruby-and-rcov_plugin/">rcov jruby and rcov_plugin</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2009/04/10/jruby-on-rails-and-google-app-engine/">jruby on rails and google app engine</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2008/11/20/rails-performance-scripts-profiler-benchmarker/">rails performance scripts profiler benchmarker</a>
        </li>
	    
	     <li  class="mb2">
          <a href="/writings/2008/11/18/merb-turns-10-and-started-driving-me-crazy/">merb turns 10 and started driving me crazy</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="http://leonardoborges.com/" >
    &copy;  Leonardo Borges 2025 
  </a>
    <div><div class="ananke-socials"><a href="https://github.com/theleoborges/" target="_blank" rel="noopener"
        class="ananke-social-link link-transition github link dib z-999 pt3 pt0-l mr1"
        title="follow on GitHub - Opens in a new window"
        aria-label="follow on GitHub - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
            
          </span></a><a href="https://twitter.com/theleoborges" target="_blank" rel="noopener"
        class="ananke-social-link link-transition twitter link dib z-999 pt3 pt0-l mr1"
        title="follow on Twitter - Opens in a new window"
        aria-label="follow on Twitter - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
            
          </span></a><a href="http://linkedin.com/in/theleoborges" target="_blank" rel="noopener"
        class="ananke-social-link link-transition linkedin link dib z-999 pt3 pt0-l mr1"
        title="follow on LinkedIn - Opens in a new window"
        aria-label="follow on LinkedIn - Opens in a new window">
      <span class="icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
            
          </span></a></div>
</div>
  </div>
</footer>

  </body>
</html>
